\section{INTRODUCTION}
%
%\begin{figure}[tb!]
%	\centering
%	\begin{tabular}{ccc} 
%		\includegraphics[height=8em,width=10em]{figures/migrating_starlings.jpg} 
%		&
%		\includegraphics[height=8em,width=10em]{figures/roosting.jpg} 
%		& 
%		\includegraphics[height=8em,width=10em]{figures/starlings_fly.jpg} 
%		 \\	
%		\includegraphics[height=8em,width=10em]{figures/starlings_split.jpg}
%		&
%		\includegraphics[height=8em,width=10em]{figures/starlings_tube.jpg} 
%		&
%		\includegraphics[height=8em,width=10em]{figures/starlings_funnel.jpg}
%	\end{tabular}
%	\caption{Starlings murmurations. From the top-left and clockwise. (i) A starlings flock rises into the air, in a dense structure (Reuters/Amir Cohen).  (ii) Starlings migrating over an Israeli village (AP Photo/Oded Balilty). (iii) Starlings feeding on laid seeds  in the ground in Romania. (iv) Two flocks of migrating starlings (Menahem Kahana/AFP/Getty Images). (v) A concentric conical formation of starlings (Courtesy of \href{http://www.thegatheringsite.net/qcgems/2014/1/24/murmuration}{The Gathering Site.}). (vi)  Splitting and joining of a flock of starlings.} 
%	\label{fig:murmurations}
%\end{figure}

In multi-agent systems, the interconnection among subsystems can be characterized as moving interfaces, boundaries of local regions or cells that interact, or mixing of interacting organism substructures. The kinematics and kinetics of such  systems involve topologically complex domain reformulation which are often difficult to resolve in a conceptual, computational, and numerically robust manner.

In this paper, we will establish a general theorem for systems that exhibit the structural properties described in the foregoing for the practical verification of complex nonlinear systems whose global dynamical evolution is an aggregation of multiple local kinematics and kinetics that emerge collectively across the  subsystems or regions of a large state space. %Our scope is limited to the verification of such systems. 
With Bolza-type objective functionals and backward reachability theory, we will aggregate the over-approximated  backward reach avoid tubes or sets (BRATs) of the respective subsystems across space and time scales.  To achieve this goal, we will leverage our understanding of flocking in natural swarms, particularly European starlings (\textit{Sturnus vulgaris}), as well as rely on tools from level set methods~\cite{SethianLSBook, OsherFronts}. Applications of the principles described herein may include the verification of cyber-physical systems or CPS, multi-agent robotic systems requiring dynamical dexterity~\cite{SeqCompKoditschek}, or  dynamical systems with locally valid asymptotic controllers that do not admit a continuous control law for arriving at a globally asymptotically stable solution~\cite[Theorem II]{Brockett83}.  Mostly, we will work locally in our formulations, but occasionally will make global remarks. 

Differential optimal control theory and games offer a useful paradigm for resolving the safety of multiple agents interacting over a large shared space. Both rely on the resolution of the Hamilton-Jacobi-Bellman (HJB) equation or its Isaacs counterpart (HJI).  As HJ-type equations are seldom regular enough to admit a classical solution for almost all \textit{practical} problems, ``weaker" or ``viscosity" solutions~\cite{Lions1982, Evans1984, Crandall1984} provide generalized  solutions to HJ partial differential equations (P.D.E.s) under relaxed regularity conditions; these viscosity solutions are not necessarily differentiable anywhere in the state space, and the only regularity prerequisite in the definition is continuity~\cite{Crandall1983viscosity}. However, wherever they are differentiable, they satisfy the  values of HJ P.D.E.s in a classical sense. Thus, they lend themselves well to many real-world problems existing at the interface of discrete, continuous, and hybrid systems~\cite{LygerosReachability,  Mitchell2020, Souganidis, Mitchell2005}.

With the elegant theoretical results of \cite{CrandallLaxFriedrichs, Crandall1984Approx, Evans1984, OsherShuENO, Crandall1984}, stable essentially non-oscillatory  Lax-Friedrichs numerical integration schemes provide  \textit{consistent} and \textit{monotone} viscosity solutions (with high accuracy and precision \textit{on a mesh}) to multi-dimensional HJ-type equations\footnote{Consistent solutions to HJ equations are those whose explicit marching schemes via discrete  approximations to the HJ IVP agree with the nonlinear HJ solution~\cite{Crandall1984Approx}. Such schemes are said to be \textit{monotone} \eg on $\left[-\reline, \reline\right]$ if the numerical approximation to the vector field of interest is a nondecreasing function of each argument of the discrete approximation to the vector field.}.
%\footnote{By consistency, we mean that the numerical approximation to the HJ equation agrees with a defined HJ initial value problem; and by monotonicity, we mean the explicit marching schemes an Hamiltonian's flux are a non-decreasing function (for a 1-D case) of each argument of the vector field upon which the system is defined. For more details, see~\cite{Crandall1984Approx, OsherShuENO}.}.
However, by discretizing the Hamiltonian on a dimension-by-dimension basis, the scheme suffers from scalability~\cite{SylviaScalability, Bajcsy, Bansal} as a result of the exponential computational complexity. Given the limits of computational resources and memory when resolving practical problems for multiagent systems, what if we exploit local structures within a complex system and resolve the overall Hamiltonian by an aggregation of the computation of the numerical fluxes of local Hamiltonians? This is the central question that this paper seeks to address.


\textbf{Paper Goals}: Our goal here is the verification of  \textit{complex} and \textit{nonlinear} behavior of  \textit{multi-agent autonomous systems} that is robust against a worst-case disturbance, and preserves local safety objectives \textit{under global cohesion goals}. We limit our scope to providing a framework for separately computing the extremals of local payoffs of state space substructures over as large a range of initial conditions as desired over a complex state space,   and providing a means for aggregating such locally computed values at the end of each Lax-Friedrichs numerical integration scheme~\cite{Crandall1984Approx, OsherShuENO}. 
We consider local control laws in separated partitions of the state space as a procedure for synthesizing the practical verification of nonlinear systems. By properly coordinating local control laws, coordinated influence across workspace regions can be exerted over a wider range. 
As a motivating example, we analyze the problem within the framework of two-person vehicular dynamics over a large state space.  

\textbf{Natural Swarms as an Inspiration}: 
Natural swarms provide clues on efficiently constructing a game's outcome(s), Hamiltonians, control laws, and strategies that govern the transient behaviors of many systems that possess structural subsystems with the properties we have introduced in the foregoing. We now know that local flocks within large murmurations of starlings maintain an anisotropic formation based on a topological interaction, regardless of sparsity of birds within a flock~\cite{Cavagna2010Scale}. Thus, intra- and inter-flock collision are avoided and attacks are fended off~\cite{Ballerini1232}.
 
%Given the plethora of possible applications of CPS, questions of robustness, and invariance have received broad attention in the dynamics and control literature lately. For continuous and hybrid systems, the scalability of  verification and validation methods is timely in analyzing the safety of complex infrastructure such as ground traffic management systems~\cite{GroundTrafficMgt}, air traffic management systems~\cite{Tomlin2000Game}, flight control systems~\cite{Mitchell2020, SylviaScalability}, the invariance of quadrupedal locomotion~\cite{QuadCBF}, or adaptive cruise control~\cite{CBFCruiseControl}, \textit{inter alia}. 


%Recently, Mitchell~\cite{Mitchell2020} cast the nonlinear dynamical system under the popular backward reachability problem~\cite{Mitchell2005} as a nonconvex \textit{robustly controlled backward reachable tube} (or RCBRT) with  non-differentiability in certain portions of its hypersurface. He prescribed possible extensions to pursuit-evasion \textit{games of kind} with metric-based distances between agents in order to evaluate \textit{captures}\footnote{Captures occur when an adversarial player in a game pushes a protagonist player into danger.}. While these prescriptions are easy to prescribe for finite agents interacting on a finite state space, forming metric-based distance captures for multiple agents interacting over a large state space is daunting, since the rules that govern agents' collision cannot be described by simple sum of squares of distance between vehicles. 

%

Through empirical~\cite{Ballerini1232, Helbing20, VicsekPhaseNovel} %, Cavagna2010Scale, Bialek2012Statistical} 
and theoretical findings~\cite{JadbabaieCoord}, evidence now abounds that in certain natural species that exhibit collective behavior \todo{(see \autoref{fig:murmurations})}, convergence and group cohesion is based on simple topological interaction rules that they use to keep a tab on one another in \textit{local flocks} for collision avoidance, preserving density and structure, flock splitting, vacuole, cordon, and flash expansion~\cite{NatGeo}. This helps these animals preserve an eye-pleasing local anisotropic synchrony, which taken together among possibly hundreds of thousands of local interactions\footnote{It has been reported that no birds fly together with greater coordination and complexity than European starlings,  with murmurations counting upwards of 750,000 individual birds!}~\cite{NatGeo}, keep these animals whirling, swooping, and flying in an isotropic formation~\cite{Ballerini1232}. Thus, individual agents aggregate into finite flocks, and flock motion is synergized via local topological interactions in order to realize a stable global heading and cohesion~\cite{JadbabaieCoord}. There exists evidence that when an individual within a flock of starlings senses danger (\eg an attack from a Peregrine Falcon), it changes its course immediately. Owing to the lateral vision in such animals, immediate \textit{nearest neighbors} change course in response. This information is propagated across the entire group of flocks within the fraction of a second~\cite{Ballerini1232}, resulting in the beautiful formations \todo{\cf \autoref{fig:murmurations}}. 

 %, and there are strong reasons to believe that the birds keep warm in winter when they exercise these  behaviors before traveling to their roosting site. %It therefore begs the question, why have control systems practitioners not looked into this to leverage the collective behavior in solving multiagent control?
%
%Recently, Jadbabaie et. al proposed a linear switching control law  for multiple graphs that describe dynamics of multiple flocks in order to realize a steady-state heading~\cite{JadbabaieCoord} for \eg a murmuration of starlings. 
%In this paper, we propose a separated representation of a \textit{large backward reach avoid tube} (or \textbf{LargeBRAT}) by leveraging the control laws found in nature and using tools in reachability analysis in verifying the trajectories of large dynamical systems -- mostly arising from the local anisotropic density and structure of swarms, and the global isotropic formation of murmurations. 
%
%While our \textit{objective} in this paper leverages  the chasms of decades of research conducted in understanding collective animal behaviors, and in particular European starlings murmurations\footnote{It has been reported that no birds fly together with greater coordination and complexity as European starlings, with murmurations counting upwards of 750,000 individual birds!~\cite{NatGeo}}, our ultimate \textit{aim} is to extend what we know from these behaviors in the \textit{verification of cyberphysical systems}. Cyberphysical systems (or CPS) are  a complex interconnection of control systems, sensors, and their software whose communication protocols involve a complex labyrinth of interactions that may be difficult to analyze or synthesize with closed-form analytical propositions.  Traditionally engineered to sense and interact with the physical world ``smartly", they  may include modern manufacturing assembly lines where humans and machines jointly work to deliver products to a supply chain controlled by computer software resources, personalized interoperable medical devices, autonomous cars on a highway, (almost unmanned) long-hauled passenger flights, or general logistics \textit{inter alia}. 
%

\begin{comment}
\subsection{Alleviating Mesh Constraints}
With essentially non-oscillating (ENO)~\cite{OsherShuENO} Lax-Friedrichs~\cite{CrandallLaxFriedrichs} (or level set) schemes applied to numerically resolve HJ Hamiltonians~\cite{Evans1984}, we can now obtain  unique (viscosity) solutions to HJ-type equations with high accuracy and precision \textit{on a mesh}.  However, by employing meshes for resolving inviscid Euler equations whose solutions are the derivatives of HJ equations, these methods scale exponentially with state dimensions, making them ineffective for complex systems  -- a direct consequence of \textit{curse of dimensionality}~\cite{Bellman1957}. As a result, there is now a concerted effort within the control and machine learning research community to scale these schemes for complex systems. Consider a problem defined in a space with dimension $n=12$ based on the non-incremental time-space discretization of each space coordinate. For $n=100$ nodes, the total nodes required is $10^{120}$ on the volumetric grid\footnote{Whereas, there are only $10^{97}$ baryons in the observable universe (excluding dark matter)!}. The curse of dimensionality~\cite{Bellman1957} therefore greatly incapacitates  grid discretization methods for guaranteeing the robustness of backward reachable sets (BRS) and tubes (BRTs)~\cite{Mitchell2005} of complex systems. 

Recent works considered scaling up these meshes for higher-dimensional physical systems. For example,  the authors of~\cite{Bajcsy} provide local updates to BRS in  unknown static environments with obstacles that may be unknown aforetime to the agent; using standard meshing techniques for time-space uniform discretization over the entire physical space, and only updating points traversed locally, a safe navigation problem was solved in an   environment assumed to be static. This makes it non-amenable to \textit{a priori} unknown \textit{dynamic} environments where the optimal value to the min-max HJ problem may need to be adaptively updated based on changing dynamics. In ~\cite{SylviaScalability}, the grid was refined along the temporal dimension, leveraging local decomposition schemes together with warm-starting optimization of the value function from previous solutions in order to accelerate learning for safety under the assumption that the system is either completely decoupled, or coupled over so-called ``self-contained subsystems".  While the empirical results of~\cite{Bansal} demonstrate the feasibility of optimizing for the optimal value function in backward reachability analysis for up to ten dimensions for a system of Dubins vehicles, there are no guarantees that are provided. An analysis exists for a 12 dimensional systems~\cite{KaynamaScalable} with up to a billion data points in the state space, that generates robustly optimal trajectories. However, this is restricted to {linear systems}. Other associated techniques scale reachability with function approximators~\cite{FisacTAC, FisacICRA} in a reinforcement learning framework; again these methods lose  hard safety guarantees owing to the approximation in value function space.  Although these schemes are promising, they either fail to preserve guarantees or have limited scalability powers for complex dynamical systems. While truncated power series methods such as successive approximations to HJ value functions~\cite{McReynolds1967, Jacobson1968new, Mitter1966, JacobsonMayne, DenhamDDP, TodorovCDC} may appear appealing for these problems; they only provide local quadratic convergence guarantees, and the stability region of the resulting controller is limiting since it requires a careful tuning in order to have a direct consequence on the original optimal control problem~\cite{Beard1998}.
\end{comment}

%\subsection{Collective Behavior From Local Objectives}
%
%\noindent \textbf{Paper Goals}:  % when solving the terminal value of the Cauchy-type HJ~\cite{Crandall1983viscosity} Reachability problem~\cite{Mitchell2005, LygerosReachability}. % We draw inspiration from  movement of animal groups with an emphasis on emergent complex behaviors via local interactions. Compelling evidence suggests that by observing local anisotropic formation behaviors~\cite{Ballerini1232}, collective behaviors emerge which helps maintain global isotropic behaviors that preserve unique formation patterns and group cohesion. 

%Seeing that these animals are able to generate emergent complex behaviors from local adaptive interactions with their nearest neighbors, we find it compelling to draw inspiration from these collective interactions. To analyze safety, we formulate the problem within \textit{Cauchy-type} HJ problems~\cite{Crandall1983viscosity}, and we resolve the  differential optimal control~\cite{LygerosReachability} problem within the \textit{robustly backward reachable tube} scheme of~\cite{Mitchell2020}. Our focus is verifying complex cohesion behaviors in multi-agent dynamical systems, interacting over a large state space, while mitigating against the computational complexity associated with computing large backward reach-avoid-tubes(BRATs)~\cite{SylviaScalability, Bajcsy, DecompChenHerbert}. While the inspiration for this verification work draws from Mitchell's body of work~\cite{Mitchell2005}, we broaden the definition of target sets and system dynamics from basic Dubins' scheme formulations to consensus headings of vehicular dynamics under  topological  nearest neighbor rules in manifolds of the state space. 
%All of these are employed to synthesize approximately optimal control laws (essentially, saddle-point solutions) \todo{with stability guarantees} for resolving the terminal value in the viscosity solutions to HJI value functions.
%\subsubsection{Insufficiency of Global Mesh-based Methods}


\begin{figure}[tb!]
	\centering
	\includegraphics[width=\columnwidth]{figures/flock_pursuer.jpg}
	\caption{Illustration of robust heading consensus for a flock with 8 aircraft. The evading player has all the evading agents under the will of its strategy.  To every evading flock, there is at most one pursuing player. }
	\label{fig:robust_heading}
\end{figure}
%
While Jadbabaie et al.~\cite{JadbabaieCoord} introduced a graphical formulation based on a switched linear system to demonstrate that nearest neighbor rules cause agents to converge to the same heading, we stick with the nonlinear model of the system and employ \textit{reachability analysis} as a verification tool.  We introduce new insights, and computational techniques aimed at solving \textit{practical} problems that cannot be otherwise analytically resolved nor numerically resolved without exploiting state substructures and parallelism. This work is the first to systematically provide a rational separated value function aggregation  scheme on local state space substructures in computing \textit{robustly controlled backward reachable tubes  (RCBRTs)}~\cite{Mitchell2020} for complex systems. The body of this paper is structured as follows: we introduce common notations and definitions in \autoref{sec:notations}; \autoref{sec:related} describes the concepts and topics as needed for our proposed scheme in \autoref{sec:methods}; we present results and insights from experiments in \autoref{sec:expts}. Lastly, we  conclude with remarks in \autoref{sec:conclude}.  